<script>
  const logElement = document.getElementById("status-log");

  async function fetchLog() {
    try {
      const res = await fetch("/get-log");
      const data = await res.json();

      if (data.log && data.log.length > 0) {
        logElement.innerText = data.log.join('\n');
        logElement.scrollTop = logElement.scrollHeight;
      } else {
        logElement.innerText = "Waiting for updates...";
      }
    } catch (err) {
      logElement.innerText = "Error retrieving logs.";
    }
  }

  // Call every 1000ms (1 second) for 5 minutes
  let pollCount = 0;
  const maxPolls = 300;

  const interval = setInterval(() => {
    if (pollCount >= maxPolls) {
      clearInterval(interval);
      logElement.innerText += "\n[Timeout reached. Please check your connection or try again.]";
    } else {
      fetchLog();
      pollCount++;
    }
  }, 1000);
</script>
